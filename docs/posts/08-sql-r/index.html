<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Marie">
<meta name="dcterms.date" content="2025-11-28">
<meta name="description" content="Learn mastering both — and how to make them work together seamlessly.">

<title>Why SQL + R is an affable combo when I start learning SQL? – Joshua Marie</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/jm-favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a95de2c3be981c2e03029825b16c585.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-4f90e7b736d88b8ae6544ef5f78d50a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/social-share-1.0.0/social-share.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/social-share-1.0.0/all.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9842567530621468" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles/base.css">
<link rel="stylesheet" href="../../styles/layout.css">
<link rel="stylesheet" href="../../styles/hero.css">
<link rel="stylesheet" href="../../styles/cards.css">
<link rel="stylesheet" href="../../styles/about.css">
<link rel="stylesheet" href="../../styles/dark-mode.css">
<link rel="stylesheet" href="../Theme/code.css">
<link rel="stylesheet" href="../Theme/table.css">
<meta name="twitter:title" content="Why SQL + R is an affable combo when I start learning SQL? – Joshua Marie">
<meta name="twitter:description" content="Learn mastering both — and how to make them work together seamlessly.">
<meta name="twitter:image" content="https://joshuamarie.com/posts/08-sql-r/image.png">
<meta name="twitter:image-height" content="788">
<meta name="twitter:image-width" content="940">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Joshua Marie</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contacts.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">My resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts/index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/joshuamarie"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/joshuamarie/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:joshua.marie.k@gmail.com"> <i class="bi bi-envelope" role="img" aria-label="Email">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img" aria-label="RSS Feed">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Why SQL + R is an affable combo when I start learning SQL?</h1>
                  <div>
        <div class="description">
          Learn mastering both — and how to make them work together seamlessly.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">SQL</div>
                <div class="quarto-category">data-science</div>
                <div class="quarto-category">analytics</div>
                <div class="quarto-category">tidyverse</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Joshua Marie </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 28, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#why-learn-sql-through-r" id="toc-why-learn-sql-through-r" class="nav-link" data-scroll-target="#why-learn-sql-through-r"><span class="header-section-number">2</span> Why Learn SQL Through R?</a></li>
  <li><a href="#tools-and-packages" id="toc-tools-and-packages" class="nav-link" data-scroll-target="#tools-and-packages"><span class="header-section-number">3</span> Tools and Packages</a></li>
  <li><a href="#with-existing-database" id="toc-with-existing-database" class="nav-link" data-scroll-target="#with-existing-database"><span class="header-section-number">4</span> With existing database</a>
  <ul class="collapse">
  <li><a href="#why-sqlite-is-perfect-for-learning" id="toc-why-sqlite-is-perfect-for-learning" class="nav-link" data-scroll-target="#why-sqlite-is-perfect-for-learning"><span class="header-section-number">4.1</span> Why SQLite is Perfect for Learning</a></li>
  <li><a href="#sqlite-in-r" id="toc-sqlite-in-r" class="nav-link" data-scroll-target="#sqlite-in-r"><span class="header-section-number">4.2</span> SQLite in R</a></li>
  <li><a href="#two-ways-to-query-pure-sql-vs-dplyr" id="toc-two-ways-to-query-pure-sql-vs-dplyr" class="nav-link" data-scroll-target="#two-ways-to-query-pure-sql-vs-dplyr"><span class="header-section-number">4.3</span> Two Ways to Query: Pure SQL vs {dplyr}</a></li>
  <li><a href="#working-with-query-results" id="toc-working-with-query-results" class="nav-link" data-scroll-target="#working-with-query-results"><span class="header-section-number">4.4</span> Working with Query Results</a></li>
  <li><a href="#database-hygiene" id="toc-database-hygiene" class="nav-link" data-scroll-target="#database-hygiene"><span class="header-section-number">4.5</span> Database Hygiene</a></li>
  </ul></li>
  <li><a href="#learning-sql-in-r-without-a-server" id="toc-learning-sql-in-r-without-a-server" class="nav-link" data-scroll-target="#learning-sql-in-r-without-a-server"><span class="header-section-number">5</span> Learning SQL in R without a server</a>
  <ul class="collapse">
  <li><a href="#what-are-simulated-connections" id="toc-what-are-simulated-connections" class="nav-link" data-scroll-target="#what-are-simulated-connections"><span class="header-section-number">5.1</span> What Are Simulated Connections?</a></li>
  <li><a href="#demonstration-simulating-microsoft-sql-server" id="toc-demonstration-simulating-microsoft-sql-server" class="nav-link" data-scroll-target="#demonstration-simulating-microsoft-sql-server"><span class="header-section-number">5.2</span> Demonstration: Simulating Microsoft SQL Server</a></li>
  <li><a href="#comparing-sql-dialects" id="toc-comparing-sql-dialects" class="nav-link" data-scroll-target="#comparing-sql-dialects"><span class="header-section-number">5.3</span> Comparing SQL Dialects</a></li>
  <li><a href="#when-to-use-simulated-connections" id="toc-when-to-use-simulated-connections" class="nav-link" data-scroll-target="#when-to-use-simulated-connections"><span class="header-section-number">5.4</span> When to Use Simulated Connections</a></li>
  </ul></li>
  <li><a href="#common-pitfalls-and-how-to-avoid-them" id="toc-common-pitfalls-and-how-to-avoid-them" class="nav-link" data-scroll-target="#common-pitfalls-and-how-to-avoid-them"><span class="header-section-number">6</span> Common Pitfalls and How to Avoid Them</a>
  <ul class="collapse">
  <li><a href="#collecting-too-early" id="toc-collecting-too-early" class="nav-link" data-scroll-target="#collecting-too-early"><span class="header-section-number">6.1</span> 1. Collecting Too Early</a></li>
  <li><a href="#not-checking-query-plans" id="toc-not-checking-query-plans" class="nav-link" data-scroll-target="#not-checking-query-plans"><span class="header-section-number">6.2</span> 2. Not Checking Query Plans</a></li>
  <li><a href="#forgetting-database-differences" id="toc-forgetting-database-differences" class="nav-link" data-scroll-target="#forgetting-database-differences"><span class="header-section-number">6.3</span> 3. Forgetting Database Differences</a></li>
  <li><a href="#ignoring-indexes" id="toc-ignoring-indexes" class="nav-link" data-scroll-target="#ignoring-indexes"><span class="header-section-number">6.4</span> 4. Ignoring Indexes</a></li>
  <li><a href="#not-parameterizing-queries" id="toc-not-parameterizing-queries" class="nav-link" data-scroll-target="#not-parameterizing-queries"><span class="header-section-number">6.5</span> 5. Not Parameterizing Queries</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">7</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/joshuamarie/joshuamarie/edit/main/posts/08-sql-r/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/joshuamarie/joshuamarie/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">
<div class="page-columns page-rows-contents page-layout-article"><div class="social-share"><a href="https://twitter.com/share?url=https://joshuamarie.com/posts/08-sql-r&amp;text=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="twitter"><i class="fab fa-twitter fa-fw fa-lg"></i></a><a href="https://www.linkedin.com/shareArticle?url=https://joshuamarie.com/posts/08-sql-r&amp;title=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a>  <a href="mailto:?subject=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie&amp;body=Check out this link:https://joshuamarie.com/posts/08-sql-r" target="_blank" class="email"><i class="fa-solid fa-envelope fa-fw fa-lg"></i></a><a href="https://www.facebook.com/sharer.php?u=https://joshuamarie.com/posts/08-sql-r" target="_blank" class="facebook"><i class="fab fa-facebook-f fa-fw fa-lg"></i></a><a href="https://reddit.com/submit?url=https://joshuamarie.com/posts/08-sql-r&amp;title=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="reddit">   <i class="fa-brands fa-reddit-alien fa-fw fa-lg"></i></a><a href="https://www.stumbleupon.com/submit?url=https://joshuamarie.com/posts/08-sql-r&amp;title=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="stumbleupon"><i class="fa-brands fa-stumbleupon fa-fw fa-lg"></i></a><a href="https://www.tumblr.com/share/link?url=https://joshuamarie.com/posts/08-sql-r&amp;name=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="tumblr"><i class="fa-brands fa-tumblr fa-fw fa-lg"></i></a><a href="javascript:void(0);" onclick="var mastodon_instance=prompt('Mastodon Instance / Server Name?'); if(typeof mastodon_instance==='string' &amp;&amp; mastodon_instance.length){this.href='https://'+mastodon_instance+'/share?text=Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie https://joshuamarie.com/posts/08-sql-r'}else{return false;}" target="_blank" class="mastodon"><i class="fa-brands fa-mastodon fa-fw fa-lg"></i></a><a href="https://bsky.app/intent/compose?text=https://joshuamarie.com/posts/08-sql-r Why SQL + R is an affable combo when I start learning SQL? — Joshua Marie" target="_blank" class="bsky"><i class="fa-brands fa-bluesky"></i></a></div></div>





<p><img src="image.png" class="img-fluid"></p>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>I am already using R since 2018, and uses SQL since around 2022-2023. Way back in 2023, I am learning one of the most valuable feature in R, and that’s the ability to integrate R into other software. That’s because I only use softwares independently, i.e.&nbsp;R only, Python only, etc. This is how I first learn SQL, and I learn few frameworks that integrates R and SQL databases.</p>
<p>If you’ve spent any time in data science, I am sure you encountered language wars and such debates — there’s like hundreds or maybe thousands of blogs spread in the community comparing which languages is better or worse. I am not talking about that in this blog post, however, here’s the thing — it’s not really a versus situation. SQL and R are like peanut butter and jelly. Each is good on its own, but why not both? <em>Flavorful</em>.</p>
<!-- ![](why-not-both.gif) -->
<p>Regardless, SQL excels at what databases do best: storing, organizing, and retrieving massive amounts of data with lightning speed. R, on the other hand, shines where creativity and complexity matter: statistical modeling, advanced visualizations, and transforming raw data into insights that actually mean something.</p>
<p>In this post, I’ll show you why combo-ing R and SQL isn’t just nice to have — it’s my stack. And more importantly, I’ll show you what I know how to make them work together so seamlessly you’ll wonder how you ever worked any other way.</p>
</section>
<section id="why-learn-sql-through-r" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="why-learn-sql-through-r"><span class="header-section-number">2</span> Why Learn SQL Through R?</h2>
<p>Before we dive into the technical details, let me explain why R is actually a fantastic environment for learning SQL:</p>
<ol type="1">
<li><p>Immediate Feedback Loop</p>
<p>When you’re learning SQL in a traditional database environment, you often need to set up servers, configure connections, and deal with authentication. With R, you can start writing queries in seconds and see results immediately in your familiar R environment.</p></li>
<li><p>Best of Both Worlds</p>
<p>You can write pure SQL when you want to practice, or use <code>{dplyr}</code> syntax and see the generated SQL. This dual approach accelerates learning because you can:</p>
<ul>
<li>Write <code>{dplyr}</code> code and inspect the SQL it produces</li>
<li>Compare your hand-written SQL with <code>{dbplyr}</code>’s output</li>
<li>Gradually transition from <code>{dplyr}</code> comfort to SQL mastery</li>
</ul></li>
<li><p>Visualization Integration</p>
<p>The moment you query data, you can pipe it directly into <code>{ggplot2}</code> or other R visualization tools. No export/import cycles, no switching between applications—just seamless analysis.</p></li>
<li><p>Reproducible Workflows</p>
<p>Everything lives in a script or R Markdown document. Your queries, analysis, and visualizations are all version-controlled and reproducible.</p></li>
</ol>
</section>
<section id="tools-and-packages" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="tools-and-packages"><span class="header-section-number">3</span> Tools and Packages</h2>
<p>I can name few tools and packages on working with SQL databases in R, most especially when you just started. I don’t have any database in my own device, but did you know you can simulate databases? These are the tools and packages to start:</p>
<ol type="1">
<li><p><code>{tidyverse}</code> — Why this? This is a package that holds the complete set of tools in data science, and that includes working with databases. Speaking of which, this is a <em>meta-package</em> that also contains what we need: <code>{dbplyr}</code>, which also contains <code>{DBI}</code> package dependency.</p></li>
<li><p><code>{box}</code> — I already talked about this package in my previous blog posts. Please, take a look at them if you have some time:</p>
<ul>
<li><a href="https://joshuamarie.com/posts/03-modules-in-r/">Box: Placing module system into R</a></li>
<li><a href="https://joshuamarie.com/posts/06-load-pkg/#box">In my “Ways to load / attach packages in R” blog post</a></li>
</ul></li>
<li><p><code>{dbplyr}</code> — This is the magic translator. It converts your familiar <code>{dplyr}</code> code into SQL queries behind the scenes. You write R, it speaks SQL to the database. The best part? You can inspect the SQL it generates, which makes it a fantastic learning tool.</p></li>
<li><p><code>{DBI}</code> — Think of this as the universal adapter for database connections. It provides a consistent interface whether you’re connecting to SQLite, PostgreSQL, MySQL, or other databases. It handles the connection, sending queries, and fetching results.</p></li>
<li><p><code>{RSQLite}</code> — This is the R interface to SQLite databases. SQLite is perfect for learning because it’s lightweight, requires no server setup, and the entire database is just a single file on your computer.</p></li>
</ol>
<p>Install them through this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Native R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Using <strong>{pak}</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="st">'box'</span>, <span class="st">'RSQLite'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Install them directly</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pak<span class="sc">::</span><span class="fu">pak</span>(<span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tidyverse'</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'box'</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RSQLite'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>When you preferred the development version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pak<span class="sc">::</span><span class="fu">pak</span>(<span class="fu">c</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tidyverse/tidyverse"</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"klmr/box"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"r-dbi/RSQLite"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</section>
<section id="with-existing-database" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="with-existing-database"><span class="header-section-number">4</span> With existing database</h2>
<p>I learn SQL thanks to SQLite. This is a language-agnostic library, written in C, that acts like a database while being lightweight. You can use it literally everywhere! It is also used to built into everywhere, it could be mobile phones and most computers.</p>
<p>Thanks to SQLite, I made a first move to learn SQL without installing heavy softwares, such as PostgreSQL and MySQL, just to learn SQL. Additionally, SQLite is an open-source, but not open for contribution (I believe this is designed for good purpose).</p>
<section id="why-sqlite-is-perfect-for-learning" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="why-sqlite-is-perfect-for-learning"><span class="header-section-number">4.1</span> Why SQLite is Perfect for Learning</h3>
<p>Here’s why SQLite is the ideal training ground:</p>
<ul>
<li><strong>No server required</strong> — It’s just a file on your computer</li>
<li><strong>Zero configuration</strong> — No ports, users, or permissions to set up</li>
<li><strong>Lightweight</strong> — Databases can be megabytes instead of gigabytes</li>
<li><strong>Production-ready</strong> — Despite being “lite,” it’s used in production by major applications</li>
<li><strong>SQL standard</strong> — You learn real SQL that transfers to other databases</li>
</ul>
<p>In a positive sense, R and SQL is a great combo. Maybe R and SQL is not a great combo for software development as Python and SQL combo, R and SQL can make a place in data analysis instead. As long as you have <code>{DBI}</code> and <code>{RSQLite}</code> installed in your R, you can now make a first move on integrating R and SQL, and you’re good to go.</p>
</section>
<section id="sqlite-in-r" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="sqlite-in-r"><span class="header-section-number">4.2</span> SQLite in R</h3>
<p>Oh, you can definitely learn SQL and R at the same time, considering that SQLite is portable and lightweight. The only primary requirements are <code>{DBI}</code> and <code>{RSQLite}</code>. If you know how to write a query, you don’t need a compatible set of packages in <code>{tidyverse}</code> and <code>{dbplyr}</code>, otherwise, as long as you know how to use <code>{tidyverse}</code> packages, namely <code>{dplyr}</code>, <code>{tidyr}</code>, etc., you can use it instead.</p>
<p>Let me show you how to connect to a SQLite database and work with it:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a>    DBI[dbConnect, dbWriteTable, dbDisconnect], </span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>    RSQLite[SQLite]</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-6" class="code-annotation-target"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a>con <span class="ot">=</span> <span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), <span class="st">"first_database.sqlite"</span>)</span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-9" class="code-annotation-target"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>, <span class="st">"Diana"</span>, <span class="st">"Eve"</span>),</span>
<span id="annotated-cell-1-13"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">28</span>, <span class="dv">42</span>),</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> <span class="fu">c</span>(<span class="st">"New York"</span>, <span class="st">"London"</span>, <span class="st">"Tokyo"</span>, <span class="st">"Paris"</span>, <span class="st">"Sydney"</span>)</span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-17" class="code-annotation-target"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(</span>
<span id="annotated-cell-1-19"><a href="#annotated-cell-1-19" aria-hidden="true" tabindex="-1"></a>    con, </span>
<span id="annotated-cell-1-20"><a href="#annotated-cell-1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"customers"</span>,</span>
<span id="annotated-cell-1-21"><a href="#annotated-cell-1-21" aria-hidden="true" tabindex="-1"></a>    df, </span>
<span id="annotated-cell-1-22"><a href="#annotated-cell-1-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="annotated-cell-1-23"><a href="#annotated-cell-1-23" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="6" data-code-annotation="1">Create a connection (this creates the database file if it doesn’t exist)</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="9" data-code-annotation="2">Create some sample data</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="17" data-code-annotation="3">Write the data as a <em>table</em> to the database</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Explanation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Explanation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a connection (this creates the database file if it doesn’t exist)</li>
<li>Create some sample data</li>
<li>Write the data as a <em>table</em> to the database</li>
</ol>
</div>
</div>
</div>
<p><strong>What just happened?</strong><br>
We created a SQLite database file called <code>first_database.sqlite</code> in your working directory. Inside it, we created a table called <code>customers</code> with our sample data. If the file already exists, R simply connects to it.</p>
</section>
<section id="two-ways-to-query-pure-sql-vs-dplyr" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="two-ways-to-query-pure-sql-vs-dplyr"><span class="header-section-number">4.3</span> Two Ways to Query: Pure SQL vs {dplyr}</h3>
<p>Now comes the fun part—you can query this database in two different ways, and each has its benefits for learning.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Just SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href=""><strong>{dplyr}</strong> API</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Did you know that with <code>{knitr}</code>, you can write SQL code chunks directly in your R Markdown or Quarto documents? This is incredibly handy for mixing SQL queries with your data analysis in R.</p>
<pre><code>```\{sql connection=con\}
SELECT name, age, city 
FROM customers 
WHERE age &gt; 30
```</code></pre>
<blockquote class="blockquote">
<p>Kindly remove the <code>\</code> when you copy the code chunk above.</p>
</blockquote>
<p>Alright, I wrote the SQL code chunk above again here for your reference:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> name, age, city </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> customers </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> age <span class="op">&gt;</span> <span class="dv">30</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">city</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Charlie</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">Tokyo</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eve</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">Sydney</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Or you can store the query into a string, and send it via <code>DBI::dbGetQuery()</code>, placed in <code>statement</code> argument.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    con, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT name, age, city </span><span class="sc">\n</span><span class="st">FROM customers </span><span class="sc">\n</span><span class="st">WHERE age &gt; 30"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name age   city
1 Charlie  35  Tokyo
2     Eve  42 Sydney</code></pre>
</div>
</div>
<p><strong>Why this matters for learning:</strong><br>
You’re writing actual SQL. No training wheels. This builds muscle memory for SQL syntax and helps you think in terms of SQL operations: SELECT, FROM, WHERE, JOIN, GROUP BY, etc.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Nothing can make it so easy to work with databases using a familiar syntax with <code>{dplyr}</code>. Yes, with <code>{dbplyr}</code>, you can use <code>{dplyr}</code> functions to interact with your database tables as if they were regular data frames in R. Here’s how you can perform the same query using <code>{dplyr}</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    dplyr[filter, select, tbl, collect, show_query]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>customers_tbl <span class="ot">=</span> <span class="fu">tbl</span>(con, <span class="st">"customers"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> customers_tbl <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">&gt;</span> <span class="dv">30</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name, age, city)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>out <span class="sc">|&gt;</span> <span class="fu">collect</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  name      age city  
  &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; 
1 Charlie    35 Tokyo 
2 Eve        42 Sydney</code></pre>
</div>
</div>
<p><strong>The magic behind this:</strong></p>
<p>When you use <code>{dplyr}</code> verbs on a database table, <code>{dbplyr}</code> doesn’t immediately execute anything. It’s lazy! It builds up the query and only executes it when you call <code>collect()</code>. This is efficient because:</p>
<ul>
<li>You can chain many operations without multiple round-trips to the database</li>
<li>Only the final result set gets pulled into R memory</li>
<li>The heavy computation happens in the database where it’s optimized</li>
</ul>
<p><strong>See the generated SQL:</strong></p>
<p>How about getting the SQL query generated by <code>{dbplyr}</code>? You can use the <code>show_query()</code> function to see the SQL that <code>{dbplyr}</code> generates for your <code>{dplyr}</code> code:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>out <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">show_query</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `name`, `age`, `city`
FROM `customers`
WHERE (`age` &gt; 30.0)</code></pre>
</div>
</div>
<p>Easy, right? If you know R already, treat it as your SQL teacher! Write familiar <code>{dplyr}</code> code, then check the SQL translation. Over time, you’ll start to intuitively understand how <code>filter()</code> becomes <code>WHERE</code>, how <code>select()</code> becomes <code>SELECT</code>, and how more complex operations translate to SQL.</p>
</div>
</div>
</div>
</section>
<section id="working-with-query-results" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="working-with-query-results"><span class="header-section-number">4.4</span> Working with Query Results</h3>
<p>Once you have query results, you can treat them like any R data frame:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a>    ggplot2[ggplot, aes, geom_col, theme_minimal, labs]</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-2-4"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-5" class="code-annotation-target"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a>result_data <span class="ot">=</span> <span class="fu">collect</span>(out)</span>
<span id="annotated-cell-2-7"><a href="#annotated-cell-2-7" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-8" class="code-annotation-target"><a href="#annotated-cell-2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-9"><a href="#annotated-cell-2-9" aria-hidden="true" tabindex="-1"></a>result_data <span class="sc">|&gt;</span>  </span>
<span id="annotated-cell-2-10"><a href="#annotated-cell-2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> age, <span class="at">fill =</span> city)) <span class="sc">+</span></span>
<span id="annotated-cell-2-11"><a href="#annotated-cell-2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="annotated-cell-2-12"><a href="#annotated-cell-2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="annotated-cell-2-13"><a href="#annotated-cell-2-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="annotated-cell-2-14"><a href="#annotated-cell-2-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Customers Over 30"</span>,</span>
<span id="annotated-cell-2-15"><a href="#annotated-cell-2-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Name"</span>,</span>
<span id="annotated-cell-2-16"><a href="#annotated-cell-2-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Age"</span></span>
<span id="annotated-cell-2-17"><a href="#annotated-cell-2-17" aria-hidden="true" tabindex="-1"></a>    )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="5" data-code-annotation="1">Retrieve the data</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="8" data-code-annotation="2">Now you can analyze it with R</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Explanation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Explanation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Retrieve the data</li>
<li>Now you can analyze it with R</li>
</ol>
</div>
</div>
</div>
<p>This is where the R + SQL combination really shines. You use SQL’s efficiency to get exactly the data you need, then R’s rich ecosystem for analysis and visualization.</p>
</section>
<section id="database-hygiene" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="database-hygiene"><span class="header-section-number">4.5</span> Database Hygiene</h3>
<p>Always remember to close your database connections once you’re done:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This releases resources and ensures your database file isn’t locked. In practice, connections are also closed automatically when your R session ends, but it’s good practice to do it explicitly.</p>
</section>
</section>
<section id="learning-sql-in-r-without-a-server" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="learning-sql-in-r-without-a-server"><span class="header-section-number">5</span> Learning SQL in R without a server</h2>
<p>But I know some of you wants to know what it looks like to use the existing database and then call it in R.</p>
<p>I literally said in the introduction that you can <em>simulate</em> — I have another different meaning:</p>
<ul>
<li>Use <code>simulate_*</code> family functions in <code>{dbplyr}</code> package. These functions allow you to create in-memory database tables that mimic real database behavior without needing an actual database server. This is perfect for learning and testing SQL queries in R.</li>
</ul>
<section id="what-are-simulated-connections" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="what-are-simulated-connections"><span class="header-section-number">5.1</span> What Are Simulated Connections?</h3>
<p>Simulated connections create an in-memory representation of how different database systems handle SQL. This means you can:</p>
<ul>
<li>See how your <code>{dplyr}</code> code translates to different SQL dialects</li>
<li>Learn SQL without any database installation</li>
<li>Test queries before running them on production databases</li>
<li>Understand the quirks of different database systems</li>
</ul>
</section>
<section id="demonstration-simulating-microsoft-sql-server" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="demonstration-simulating-microsoft-sql-server"><span class="header-section-number">5.2</span> Demonstration: Simulating Microsoft SQL Server</h3>
<p>First, let me show you how it looks like to connect to a database, i.e.&nbsp;SQLite in this case, and work with it. Try imagine you have a SQL server, and you want to connect to it using R. Use <code>simulate_mssql()</code> function to simulate a Microsoft SQL Server database connection:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>    dbplyr[simulate_mssql, tbl_lazy]</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-5" class="code-annotation-target"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>con_sim <span class="ot">=</span> <span class="fu">simulate_mssql</span>()</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>customers_sim <span class="ot">=</span> <span class="fu">tbl_lazy</span>(df, con_sim)</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-8" class="code-annotation-target"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>customers_sim <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name, age, city) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">&gt;</span> <span class="dv">30</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="5" data-code-annotation="1">Create a simulated MS SQL Server connection</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6" data-code-annotation="2">Create a (local) lazy table from our data frame</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="8,9,10" data-code-annotation="3">Build a query</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `name`, `age`, `city`
FROM `df`
WHERE (`age` &gt; 30.0)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Explanation">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Explanation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a simulated MS SQL Server connection</li>
<li>Create a (local) lazy table from our data frame</li>
<li>Build a query</li>
</ol>
</div>
</div>
</div>
<p>We are performing a pure lazy evaluation in this step. Which means, we are not returning any information in the table and in the query process, we only generate the SQL code.</p>
</section>
<section id="comparing-sql-dialects" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="comparing-sql-dialects"><span class="header-section-number">5.3</span> Comparing SQL Dialects</h3>
<p>The only issue when learning SQL with R in the past is when I found out that different databases have different SQL dialects. Let’s compare how PostgreSQL and Microsoft SQL Server handle the same query:</p>
<div class="columns">
<p>Let’s import a bit first:</p><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-17-1"><a href="#annotated-cell-17-1" aria-hidden="true" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="annotated-cell-17-2"><a href="#annotated-cell-17-2" aria-hidden="true" tabindex="-1"></a>    dplyr[</span>
<span id="annotated-cell-17-3"><a href="#annotated-cell-17-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">keep_when =</span> filter, arrange, desc, show_query, </span>
<span id="annotated-cell-17-4"><a href="#annotated-cell-17-4" aria-hidden="true" tabindex="-1"></a>        summarise, mutate, relocate</span>
<span id="annotated-cell-17-5"><a href="#annotated-cell-17-5" aria-hidden="true" tabindex="-1"></a>    ], </span>
<span id="annotated-cell-17-6"><a href="#annotated-cell-17-6" aria-hidden="true" tabindex="-1"></a>    tidyr[</span>
<span id="annotated-cell-17-7"><a href="#annotated-cell-17-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">long =</span> pivot_longer</span>
<span id="annotated-cell-17-8"><a href="#annotated-cell-17-8" aria-hidden="true" tabindex="-1"></a>    ], </span>
<span id="annotated-cell-17-9"><a href="#annotated-cell-17-9" aria-hidden="true" tabindex="-1"></a>    dbplyr[simulate_postgres, simulate_mssql], </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1">1</button><span id="annotated-cell-17-10" class="code-annotation-target"><a href="#annotated-cell-17-10" aria-hidden="true" tabindex="-1"></a>    magrittr[<span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span>]</span>
<span id="annotated-cell-17-11"><a href="#annotated-cell-17-11" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="10" data-code-annotation="1">This is totally optional, you still can use <code>|&gt;</code> base R pipes, after all.</span>
</dd>
</dl>
</div>
</div><div class="column" style="width:50%;">
<section id="postgresql-version" class="level4" data-number="5.3.1">
<h4 data-number="5.3.1" class="anchored" data-anchor-id="postgresql-version"><span class="header-section-number">5.3.1</span> PostgreSQL version</h4>
<div class="cell" data-output-fold="true" data-output-summary="Click to view generated SQL code">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>con_postgres <span class="ot">=</span> <span class="fu">simulate_postgres</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mtcars_postgres <span class="ot">=</span> <span class="fu">tbl_lazy</span>(mtcars, con_postgres)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>mtcars_postgres <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">hp_per_cyl =</span> hp <span class="sc">/</span> cyl,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">efficiency =</span> mpg <span class="sc">/</span> disp</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(mpg, disp, hp, hp_per_cyl, efficiency, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">across</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(mpg, hp_per_cyl, efficiency), </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">mu =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma =</span> \(x) <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>            ), </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">.names =</span> <span class="st">"{.col}..{.fn}"</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">long</span>(</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>)), </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.."</span>, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Stat"</span>), </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Est"</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<details><summary>Click to view generated SQL code</summary>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `n`, 'mpg' AS `Variable`, 'mu' AS `Stat`, `mpg..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'hp_per_cyl' AS `Variable`,
  'mu' AS `Stat`,
  `hp_per_cyl..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'efficiency' AS `Variable`,
  'mu' AS `Stat`,
  `efficiency..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT `n`, 'mpg' AS `Variable`, 'sigma' AS `Stat`, `mpg..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'hp_per_cyl' AS `Variable`,
  'sigma' AS `Stat`,
  `hp_per_cyl..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'efficiency' AS `Variable`,
  'sigma' AS `Stat`,
  `efficiency..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDDEV_SAMP(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDDEV_SAMP(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDDEV_SAMP(`efficiency`) AS `efficiency..sigma`,
    COUNT(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`</code></pre>
</div>
</details>
</div>
</section>
</div><div class="column" style="width:50%;">
<section id="microsoft-sql-server-version" class="level4" data-number="5.3.2">
<h4 data-number="5.3.2" class="anchored" data-anchor-id="microsoft-sql-server-version"><span class="header-section-number">5.3.2</span> Microsoft SQL Server version</h4>
<div class="cell" data-output-fold="true" data-output-summary="Click to view generated SQL code">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>con_mssql <span class="ot">=</span> <span class="fu">simulate_mssql</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mtcars_mssql <span class="ot">=</span> <span class="fu">tbl_lazy</span>(mtcars, con_mssql)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>mtcars_mssql <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">hp_per_cyl =</span> hp <span class="sc">/</span> cyl,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">efficiency =</span> mpg <span class="sc">/</span> disp</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(mpg, disp, hp, hp_per_cyl, efficiency, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">across</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(mpg, hp_per_cyl, efficiency), </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">list</span>(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">mu =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma =</span> \(x) <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            ), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">.names =</span> <span class="st">"{.col}..{.fn}"</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">long</span>(</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>)), </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.."</span>, </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Stat"</span>), </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Est"</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<details><summary>Click to view generated SQL code</summary>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;SQL&gt;
SELECT `n`, 'mpg' AS `Variable`, 'mu' AS `Stat`, `mpg..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'hp_per_cyl' AS `Variable`,
  'mu' AS `Stat`,
  `hp_per_cyl..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'efficiency' AS `Variable`,
  'mu' AS `Stat`,
  `efficiency..mu` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT `n`, 'mpg' AS `Variable`, 'sigma' AS `Stat`, `mpg..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'hp_per_cyl' AS `Variable`,
  'sigma' AS `Stat`,
  `hp_per_cyl..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`

UNION ALL

SELECT
  `n`,
  'efficiency' AS `Variable`,
  'sigma' AS `Stat`,
  `efficiency..sigma` AS `Est`
FROM (
  SELECT
    AVG(`mpg`) AS `mpg..mu`,
    STDEV(`mpg`) AS `mpg..sigma`,
    AVG(`hp_per_cyl`) AS `hp_per_cyl..mu`,
    STDEV(`hp_per_cyl`) AS `hp_per_cyl..sigma`,
    AVG(`efficiency`) AS `efficiency..mu`,
    STDEV(`efficiency`) AS `efficiency..sigma`,
    COUNT_BIG(*) AS `n`
  FROM (
    SELECT
      `mpg`,
      `disp`,
      `hp`,
      `hp` / `cyl` AS `hp_per_cyl`,
      `mpg` / `disp` AS `efficiency`,
      `cyl`,
      `drat`,
      `wt`,
      `qsec`,
      `vs`,
      `am`,
      `gear`,
      `carb`
    FROM `df`
    WHERE (`cyl` = 6.0)
  ) AS `q01`
) AS `q01`</code></pre>
</div>
</details>
</div>
</section>
</div>
</div>
</section>
<section id="when-to-use-simulated-connections" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="when-to-use-simulated-connections"><span class="header-section-number">5.4</span> When to Use Simulated Connections</h3>
<p>Simulated connections are perfect for:</p>
<ul>
<li><strong>Learning</strong>: Practice SQL translation without database setup</li>
<li><strong>Development</strong>: Test query logic before connecting to real databases</li>
<li><strong>Documentation</strong>: Show how queries work across different systems</li>
<li><strong>Teaching</strong>: Demonstrate SQL concepts without infrastructure requirements</li>
</ul>
</section>
</section>
<section id="common-pitfalls-and-how-to-avoid-them" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="common-pitfalls-and-how-to-avoid-them"><span class="header-section-number">6</span> Common Pitfalls and How to Avoid Them</h2>
<p>Some are based on my experience, so some of the list can be opinionated.</p>
<section id="collecting-too-early" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="collecting-too-early"><span class="header-section-number">6.1</span> 1. Collecting Too Early</h3>
<p>The problem in R can be overdramatic with large amounts of data when read and processed into memory. Unnecessarily bringing entire tables into R memory creates performance bottlenecks and can even crash your R session when datasets exceed available RAM.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Chain operations and collect only when needed. Let the database do the heavy lifting with filtering, aggregating, and joining before bringing results into R.</p>
</div>
</div>
</div>
</section>
<section id="not-checking-query-plans" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="not-checking-query-plans"><span class="header-section-number">6.2</span> 2. Not Checking Query Plans</h3>
<p>Slow queries are often the result of poor optimization, but many users never investigate why their queries take so long. Without examining the query plan, you’re flying blind—unable to identify bottlenecks, missing indexes, or inefficient joins.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use <code>explain()</code> to understand query execution. This reveals how the database processes your query and highlights optimization opportunities.</p>
</div>
</div>
</div>
</section>
<section id="forgetting-database-differences" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="forgetting-database-differences"><span class="header-section-number">6.3</span> 3. Forgetting Database Differences</h3>
<p>SQL dialects vary between database systems, and code that runs perfectly in SQLite might fail spectacularly in PostgreSQL or MySQL. These differences range from subtle syntax variations to completely different function names and behaviors.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Test with simulated connections and understand dialect differences. Use <code>{dbplyr}</code>’s <code>simulate_*()</code> functions to preview how queries translate across databases before deploying to production systems.</p>
</div>
</div>
</div>
</section>
<section id="ignoring-indexes" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="ignoring-indexes"><span class="header-section-number">6.4</span> 4. Ignoring Indexes</h3>
<p>Queries that scan entire tables are a common performance killer, especially as datasets grow. Without proper indexes, your database must examine every single row to find matches, turning what should be millisecond queries into multi-second ordeals.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Learn about indexes and how to create them for frequently queried columns. Understand which columns benefit from indexing and how composite indexes can optimize complex queries.</p>
</div>
</div>
</div>
</section>
<section id="not-parameterizing-queries" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="not-parameterizing-queries"><span class="header-section-number">6.5</span> 5. Not Parameterizing Queries</h3>
<p>Building queries with string concatenation isn’t just inelegant—it’s dangerous. This practice opens your code to SQL injection attacks, where malicious input can execute arbitrary database commands, potentially exposing or destroying data.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use parameterized queries with <code>DBI::dbBind()</code> or stick with <code>{dplyr}</code> operations, which handle parameterization automatically. Never concatenate user input directly into SQL strings.</p>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">7</span> Conclusion</h2>
<p>SQL and R aren’t competitors — they’re collaborators. SQL is your data retrieval expert, getting you exactly the data you need with incredible efficiency. R is your analysis specialist, turning that data into insights, models, and visualizations. I can guarantee you that learning SQL through R is that you’re never starting from zero. Your existing R knowledge accelerates SQL mastery. The familiar <code>{dplyr}</code> syntax becomes your bridge to SQL fluency. And the ability to seamlessly move from database queries to statistical analysis to stunning visualizations—all in one environment—is genuinely powerful.</p>
<p>The data-driven professionals who thrive are those who can speak both languages fluently. They use SQL to ask databases the right questions and R to find the answers that matter. They understand when to leverage database optimization and when to bring data into R for complex transformations.</p>
<p>The journey from R user to R + SQL expert isn’t just about learning syntax—it’s about becoming someone who can efficiently bridge data storage and data science, who understands both the “how” of data retrieval and the “why” of data analysis.</p>
<p>So don’t pick sides. Master both. Your future self (and would be your future employers) will thank you.</p>


</section>

</main> <!-- /main -->
<style>

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');



/* Light theme variables */

:root {

  --primary-color: #3b82f6;

  --primary-dark: #2563eb;

  --secondary-color: #64748b;

  --accent-color: #06b6d4;

  --background: #ffffff;

  --surface: #f8fafc;

  --surface-hover: #f1f5f9;

  --surface-light: #e2e8f0;

  --border: #e2e8f0;

  --text-primary: #0f172a;

  --text-secondary: #475569;

  --text-muted: #64748b;

  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);

  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);

  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  --radius: 8px;

  --radius-lg: 12px;

}



/* Dark theme variables */

[data-theme="dark"] {

  --primary-color: #60a5fa;

  --primary-dark: #3b82f6;

  --secondary-color: #94a3b8;

  --accent-color: #22d3ee;

  --background: #0f172a;

  --surface: #1e293b;

  --surface-hover: #334155;

  --surface-light: #475569;

  --border: #334155;

  --text-primary: #f1f5f9;

  --text-secondary: #cbd5e1;

  --text-muted: #94a3b8;

  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);

  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.4);

  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.5), 0 4px 6px -4px rgb(0 0 0 / 0.5);

}



/* =========================

   Navbar Theme Fix

   ========================= */



/* Target all navbar elements to use theme colors */

.navbar,

.navbar-default,

.navbar-expand-lg,

nav.navbar,

header.navbar,

#quarto-header,

.quarto-navbar,

nav[role="navigation"] {

  background: var(--background) !important;

  border-bottom: 1px solid var(--border) !important;

  box-shadow: var(--shadow-sm) !important;

}



/* =========================

   Title Block Banner Theme Fix

   ========================= */



/* Target title block banner area */

#title-block-header,

.quarto-title-block,

header#title-block-header,

.quarto-title-banner {

  background: var(--background) !important;

  color: var(--text-primary) !important;

}



/* Title block container */

.quarto-title-block .quarto-title,

#title-block-header .quarto-title {

  background: var(--background) !important;

}



/* =========================

   Listing Controls Theme Fix (Sorter/Filter)

   ========================= */



/* Order By / Sort dropdown and Filter input */

.listing-option-group,

.listing-actions,

.listing-controls,

div[class*="listing"] {

  background: var(--background) !important;

}



/* Dropdowns and inputs in listing controls */

.listing-option-group select,

.listing-option-group input,

#listing-order-by,

select,

input[type="text"],

input[type="search"] {

  background: var(--surface) !important;

  color: var(--text-primary) !important;

  border: 1px solid var(--border) !important;

}



.listing-option-group select:hover,

.listing-option-group input:hover,

select:hover,

input[type="text"]:hover,

input[type="search"]:hover {

  background: var(--surface-hover) !important;

  border-color: var(--primary-color) !important;

}



/* Labels in listing controls */

.listing-option-group label,

.listing-controls label {

  color: var(--text-primary) !important;

}



/* =========================

   Footer Theme Fix

   ========================= */



/* Footer area */

footer,

.footer,

.nav-footer,

.quarto-footer,

body > footer,

#quarto-footer {

  background: var(--surface) !important;

  color: var(--text-secondary) !important;

  border-top: 1px solid var(--border) !important;

}



/* Footer links */

footer a,

.footer a,

.nav-footer a,

.quarto-footer a {

  color: var(--text-secondary) !important;

}



footer a:hover,

.footer a:hover,

.nav-footer a:hover,

.quarto-footer a:hover {

  color: var(--primary-color) !important;

}



/* Footer text */

footer p,

footer div,

.footer p,

.footer div,

.nav-footer p,

.nav-footer div {

  color: var(--text-secondary) !important;

}



/* Navbar brand/logo */

.navbar-brand,

.navbar-title,

a.navbar-brand {

  color: var(--text-primary) !important;

}



/* Navbar links */

.navbar-nav .nav-link,

.navbar .nav-link,

.navbar a,

.nav-link {

  color: var(--text-secondary) !important;

}



.navbar-nav .nav-link:hover,

.navbar .nav-link:hover,

.navbar a:hover,

.nav-link:hover {

  color: var(--primary-color) !important;

}



/* Active navbar link */

.navbar-nav .nav-link.active,

.navbar .nav-link.active,

.nav-link.active {

  color: var(--primary-color) !important;

}



/* Navbar toggler*/

.navbar-toggler {

  border-color: var(--border) !important;

  padding: 0.25rem 0.5rem;

}



.navbar-toggler:focus {

  box-shadow: 0 0 0 0.2rem rgba(59, 130, 246, 0.25);

}



/* Create custom hamburger icon that respects theme */

.navbar-toggler-icon {

  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(71, 85, 105, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;

  display: inline-block;

  width: 1.5em;

  height: 1.5em;

  vertical-align: middle;

}



/* Dark theme hamburger icon */

[data-theme="dark"] .navbar-toggler-icon {

  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(203, 213, 225, 1)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;

}



/* Search button and icons in navbar */

.navbar .quarto-navbar-tools,

.navbar-nav .nav-item i,

.navbar i {

  color: var(--text-secondary) !important;

}



.navbar .quarto-navbar-tools:hover,

.navbar-nav .nav-item i:hover,

.navbar i:hover {

  color: var(--primary-color) !important;

}



/* Theme toggle button - repositioned to avoid navbar overlap */

.theme-toggle {

  position: fixed;

  bottom: 20px;

  right: 20px;

  z-index: 1000;

  background: var(--primary-color);

  color: white;

  border: none;

  width: 50px;

  height: 50px;

  border-radius: 50%;

  cursor: pointer;

  font-size: 1.25rem;

  transition: all 0.3s ease;

  box-shadow: var(--shadow-lg);

  display: flex;

  align-items: center;

  justify-content: center;

}



.theme-toggle:hover {

  background: var(--primary-dark);

  transform: scale(1.1);

  box-shadow: 0 15px 25px -5px rgb(0 0 0 / 0.3);

}



.theme-toggle:active {

  transform: scale(0.95);

}



/* Base styles with smooth transitions */

* {

  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;

}



/* Remove automatic numbering for headings */

body {

  counter-reset: none;

}



h1::before,

h2::before,

h3::before,

h4::before,

h5::before,

h6::before {

  content: none !important;

}



/* Override any automatic numbering */

.section .header-section-number {

  display: none !important;

}



.header-section-number {

  display: none !important;

}



body {

  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;

  line-height: 1.7;

  color: var(--text-primary);

  background: var(--background);

  margin: 0;

  padding: 0;

  font-size: 16px;

  -webkit-font-smoothing: antialiased;

  -moz-osx-font-smoothing: grayscale;

}



/* Container styling */

.container-fluid {

  max-width: 1200px;

  margin: 0 auto;

  padding: 2rem;

  padding-top: 4rem; 

}



/* Header styling with enhanced animations */

.title {

  font-size: 2.5rem;

  font-weight: 700;

  color: var(--text-primary);

  margin-bottom: 0.5rem;

  line-height: 1.2;

  background: linear-gradient(135deg, var(--primary-color), var(--accent-color));

  -webkit-background-clip: text;

  -webkit-text-fill-color: transparent;

  background-clip: text;

  animation: slideInFromTop 0.8s ease-out;

}



.subtitle {

  font-size: 1.25rem;

  color: var(--text-secondary);

  margin-bottom: 2rem;

  font-weight: 400;

  animation: slideInFromTop 0.8s ease-out 0.2s both;

}



.author, .date {

  color: var(--text-muted);

  font-size: 1.325rem;

  margin-bottom: 0.5rem;

  animation: slideInFromTop 0.8s ease-out 0.4s both;

}



/* Animations */

@keyframes slideInFromTop {

  from {

    opacity: 0;

    transform: translateY(-30px);

  }

  to {

    opacity: 1;

    transform: translateY(0);

  }

}



@keyframes fadeIn {

  from {

    opacity: 0;

  }

  to {

    opacity: 1;

  }

}



/* =========================

   Table of Contents

   ========================= */



#TOC {

  background: var(--surface) !important;

  border: 1px solid var(--border) !important;

  border-radius: var(--radius-lg);

  padding: 1.5rem;

  margin-bottom: 2rem;

  box-shadow: var(--shadow-sm);

  animation: fadeIn 0.8s ease-out 0.6s both;

}



/* Force all TOC elements to use theme colors */

#TOC,

#TOC ul,

#TOC li,

#TOC div {

  background: var(--surface) !important;

  color: var(--text-primary) !important;

}



/* Hide "on this page" text in TOC - Multiple selectors for compatibility */

body.quarto-post #TOC .toc-title,

#TOC .toc-title,

.toc-title,

#quarto-margin-sidebar .toc-title,

.sidebar nav[role="doc-toc"] > h2,

.sidebar nav[role="doc-toc"] > .h2,

#quarto-margin-sidebar h2,

aside[role="complementary"] h2,

nav[role="doc-toc"] h2 {

  display: none !important;

}



#TOC ul {

  margin: 0;

  padding-left: 1.25rem;

  list-style: none;

  background: var(--surface) !important;

}



#TOC > ul {

  padding-left: 0;

  background: var(--surface) !important;

}



#TOC li {

  margin: 0.5rem 0;

  position: relative;

  transform: translateX(0);

  transition: transform 0.2s ease;

  background: var(--surface) !important;

}



#TOC li:hover {

  transform: translateX(5px);

  background: var(--surface) !important;

}



#TOC li::before {

  content: "→";

  color: var(--primary-color);

  font-weight: bold;

  position: absolute;

  left: -1rem;

  opacity: 0;

  transition: opacity 0.2s ease;

}



#TOC li:hover::before {

  opacity: 1;

}



#TOC a {

  color: var(--text-primary) !important;

  text-decoration: none;

  font-weight: 500;

  transition: all 0.2s ease;

  display: block;

  padding: 0.25rem 0;

  border-radius: var(--radius);

  padding-left: 0.5rem;

  background: transparent !important;

}



#TOC a:hover {

  color: var(--primary-color) !important;

  background: var(--surface-hover) !important;

}



/* Target specific R Markdown TOC structure */

.tocify-wrapper,

.tocify-extend-page {

  background: var(--surface) !important;

}



/* Override any white backgrounds in TOC */

#TOC * {

  background-color: var(--surface) !important;

}



#TOC a * {

  background-color: transparent !important;

}



/* Floating TOC with enhanced styling */

.tocify {

  background: var(--surface) !important;

  border: 1px solid var(--border) !important;

  border-radius: var(--radius);

  box-shadow: var(--shadow-md);

  padding: 1rem;

  backdrop-filter: blur(10px);

}



.tocify-header {

  font-weight: 600;

  color: var(--text-primary) !important;

  padding: 0.5rem 0;

  border-bottom: 1px solid var(--border);

  margin-bottom: 0.5rem;

}



.tocify-item {

  padding: 0.25rem 0;

}



.tocify-item a {

  color: var(--text-secondary) !important;

  text-decoration: none;

  transition: all 0.2s ease;

  padding: 0.25rem 0.5rem;

  border-radius: var(--radius);

  display: block;

}



.tocify-item a:hover,

.tocify-item.active a {

  color: var(--primary-color) !important;

  background: var(--surface-hover) !important;

}



/* Headers styling */

h1, h2, h3, h4, h5, h6 {

  font-weight: 600;

  margin-top: 2.5rem;

  margin-bottom: 1rem;

  line-height: 1.3;

  color: var(--text-primary);

}



h1 {

  font-size: 2.25rem;

  border-bottom: 3px solid var(--primary-color);

  padding-bottom: 0.75rem;

  margin-bottom: 1.5rem;

  position: relative;

  overflow: hidden;

}



h1::after {

  content: "";

  position: absolute;

  bottom: -3px;

  left: -100%;

  right: 100%;

  height: 3px;

  background: linear-gradient(90deg, var(--accent-color), var(--primary-color));

  animation: shimmer 2s ease-in-out infinite;

}



@keyframes shimmer {

  0%, 100% {

    left: -100%;

    right: 100%;

  }

  50% {

    left: 0%;

    right: 0%;

  }

}



h2 {

  font-size: 1.875rem;

  color: var(--primary-dark);

  position: relative;

  padding-left: 1rem;

}



h2::before {

  content: "";

  position: absolute;

  left: 0;

  top: 0.25rem;

  bottom: 0.25rem;

  width: 4px;

  background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));

  border-radius: 2px;

  transform: scaleY(0);

  transform-origin: top;

  transition: transform 0.3s ease;

}



h2:hover::before {

  transform: scaleY(1);

}



h3 {

  font-size: 1.5rem;

  color: var(--text-primary);

}



h4 {

  font-size: 1.25rem;

  color: var(--secondary-color);

}



/* Interactive code folding button */

.code-folding-btn {

  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));

  color: white;

  border: none;

  padding: 0.75rem 1.25rem;

  border-radius: var(--radius);

  cursor: pointer;

  font-size: 0.875rem;

  font-weight: 600;

  transition: all 0.3s ease;

  margin-bottom: 1rem;

  position: relative;

  overflow: hidden;

}



.code-folding-btn:hover {

  transform: translateY(-2px);

  box-shadow: var(--shadow-lg);

}



.code-folding-btn:active {

  transform: translateY(0);

}



.code-folding-btn::after {

  content: "";

  position: absolute;

  top: 0;

  left: -100%;

  width: 100%;

  height: 100%;

  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);

  transition: left 0.5s ease;

}



.code-folding-btn:hover::after {

  left: 100%;

}



/* =========================

   Callout title

   ========================= */



.callout-title-container {

  color: #19183B !important;

}



/* =========================

   Global hyperlink styling

   ========================= */



/* Global styling - Light mode */

a:not(.quarto-category):not(.listing-category),

a:visited:not(.quarto-category):not(.listing-category) {

  color: #3A6F43 !important;

  text-decoration: none;

}



a:hover:not(.quarto-category):not(.listing-category) {

  color: #333333 !important;

}



/* Dark mode hyperlinks */

[data-theme="dark"] a:not(.quarto-category):not(.listing-category),

[data-theme="dark"] a:visited:not(.quarto-category):not(.listing-category) {

  color: #8BAE66 !important;

}



[data-theme="dark"] a:hover:not(.quarto-category):not(.listing-category) {

  color: #a8cc88 !important;

}



/* =========================

   Category Links Fix

   ========================= */



/* Ensure category links remain functional */

.quarto-category,

a.quarto-category,

.quarto-categories .quarto-category,

.listing-category,

a.listing-category {

  pointer-events: auto !important;

  cursor: pointer !important;

  color: inherit !important;

  text-decoration: none !important;

}



.quarto-category:hover,

.listing-category:hover {

  opacity: 0.8 !important;

  text-decoration: none !important;

}



/* =========================

   Strong Global bold text

   ========================= */



strong, b {

  font-weight: 700;

}



/* Enhanced blockquotes */

blockquote {

  border-left: 4px solid var(--accent-color);

  margin: 1.5rem 0;

  padding: 1rem 1.5rem;

  background: var(--surface);

  border-radius: 0 var(--radius) var(--radius) 0;

  color: var(--text-secondary);

  font-style: italic;

  position: relative;

  box-shadow: var(--shadow-sm);

}



blockquote::before {

  content: """;

  font-size: 3rem;

  color: var(--accent-color);

  position: absolute;

  top: -10px;

  left: 10px;

  opacity: 0.3;

}



/* Smooth scrolling and enhanced focus */

html {

  scroll-behavior: smooth;

}



/* Selection styling */

::selection {

  background: var(--primary-color);

  color: white;

}



::-moz-selection {

  background: var(--primary-color);

  color: white;

}



/* Enhanced focus styles */

button:focus,

a:focus,

input:focus,

textarea:focus {

  outline: 2px solid var(--primary-color);

  outline-offset: 2px;

  border-radius: var(--radius);

}



/* Custom scrollbar */

::-webkit-scrollbar {

  width: 12px;

}



::-webkit-scrollbar-track {

  background: var(--surface);

  border-radius: 6px;

}



::-webkit-scrollbar-thumb {

  background: var(--border);

  border-radius: 6px;

  border: 2px solid var(--surface);

}



::-webkit-scrollbar-thumb:hover {

  background: var(--secondary-color);

}



/* Responsive design */

@media (max-width: 768px) {

  .theme-toggle {

    bottom: 15px;

    right: 15px;

    width: 45px;

    height: 45px;

    font-size: 1.1rem;

  }

  

  .container-fluid {

    padding: 1rem;

    padding-top: 3rem;

  }

  

  .title {

    font-size: 2rem;

  }

  

  .subtitle {

    font-size: 1.725rem;

  }

  

  h1 {

    font-size: 1.875rem;

  }

  

  h2 {

    font-size: 1.5rem;

  }

  

  pre {

    padding: 1rem;

  }

  

  pre code {

    font-size: 0.9rem;

  }

}



/* Print styles */

@media print {

  .theme-toggle {

    display: none;

  }

  

  body {

    font-size: 12pt;

    line-height: 1.5;

    color: black;

    background: white;

  }

  

  .title {

    color: black;

    -webkit-text-fill-color: black;

  }

  

  h1, h2, h3, h4, h5, h6 {

    color: black;

    page-break-after: avoid;

  }

  

  pre, blockquote {

    page-break-inside: avoid;

  }

  

  .tocify {

    display: none;

  }

}

</style>



<script>

document.addEventListener('DOMContentLoaded', function() {

  const themeToggle = document.createElement('button');

  themeToggle.className = 'theme-toggle';

  themeToggle.innerHTML = '🌙';

  themeToggle.setAttribute('aria-label', 'Toggle dark mode');

  themeToggle.setAttribute('title', 'Toggle dark/light mode');

  

  document.body.appendChild(themeToggle);

  

  const savedTheme = localStorage.getItem('theme') || 'light';

  document.documentElement.setAttribute('data-theme', savedTheme);

  themeToggle.innerHTML = savedTheme === 'dark' ? '🌙' : '☀️';

  

  themeToggle.addEventListener('click', function() {

    const currentTheme = document.documentElement.getAttribute('data-theme');

    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

    

    document.documentElement.setAttribute('data-theme', newTheme);

    localStorage.setItem('theme', newTheme);

    themeToggle.innerHTML = newTheme === 'dark' ? '🌙' : '☀️';

    

    themeToggle.style.transform = 'rotate(360deg)';

    setTimeout(() => {

      themeToggle.style.transform = 'rotate(0deg)';

    }, 300);

  });

  

  setTimeout(function() {

    const tocTitles = document.querySelectorAll('.toc-title, #quarto-margin-sidebar h2, nav[role="doc-toc"] h2');

    tocTitles.forEach(function(title) {

      title.style.display = 'none';

    });

  }, 100);

  

  const tocLinks = document.querySelectorAll('#TOC a, .tocify a');

  tocLinks.forEach(function(link) {

    link.addEventListener('click', function(e) {

      const href = this.getAttribute('href');

      if (href && href.startsWith('#')) {

        e.preventDefault();

        const target = document.querySelector(href);

        if (target) {

          target.scrollIntoView({

            behavior: 'smooth',

            block: 'start'

          });

        }

      }

    });

  });

  

  const images = document.querySelectorAll('img');

  images.forEach(function(img) {

    if (img.complete) {

      img.style.opacity = '1';

    } else {

      img.style.opacity = '0';

      img.style.transition = 'opacity 0.5s ease';

      

      img.addEventListener('load', function() {

        this.style.opacity = '1';

      });

    }

  });

});

</script>

<style>

    /* Modal Styles */

    .code-modal {

        display: none;

        position: fixed;

        z-index: 1000;

        left: 0;

        top: 0;

        width: 100%;

        height: 100%;

        background-color: rgba(0, 0, 0, 0.8);

        backdrop-filter: blur(5px);

    }



    .code-modal-content {

        position: relative;

        background-color: #fff;

        margin: 5% auto;

        padding: 0;

        border-radius: 8px;

        width: 90%;

        max-width: 1200px;

        max-height: 80vh;

        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);

        overflow: hidden;

        display: flex;

        flex-direction: column;

    }



    .code-modal-header {

        background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%);

        color: white;

        padding: 15px 20px;

        display: flex;

        justify-content: space-between;

        align-items: center;

        border-bottom: 1px solid #ddd;

    }



    .code-modal-title {

        font-size: 1.2em;

        font-weight: 600;

        margin: 0;

    }



    .code-modal-close {

        background: none;

        border: none;

        color: white;

        font-size: 24px;

        cursor: pointer;

        padding: 0;

        width: 30px;

        height: 30px;

        border-radius: 50%;

        display: flex;

        align-items: center;

        justify-content: center;

        transition: background-color 0.2s;

    }



    .code-modal-close:hover {

        background-color: rgba(255, 255, 255, 0.2);

    }



    .code-modal-body {

        flex: 1;

        overflow-y: auto;

        padding: 20px;

        background-color: #f8f9fa;

    }



    .code-modal-section {

        margin-bottom: 20px;

    }



    .code-modal-section:last-child {

        margin-bottom: 0;

    }



    .code-modal-section h3 {

        margin: 0 0 10px 0;

        font-size: 1.1em;

        color: #333;

        padding-bottom: 5px;

        border-bottom: 2px solid #1e3a8a;

        display: flex;

        justify-content: space-between;

        align-items: center;

    }



    .code-modal-code {

        background-color: #0f172a;

        color: #e2e8f0;

        padding: 15px;

        border-radius: 6px;

        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;

        font-size: 0.9em;

        line-height: 1.4;

        overflow-x: auto;

        white-space: pre;

        margin: 0;

    }



    .code-modal-output {

        background-color: #fff;

        border: 1px solid #e2e8f0;

        padding: 15px;

        border-radius: 6px;

        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;

        font-size: 0.9em;

        line-height: 1.4;

        white-space: pre-wrap;

        margin: 0;

        color: #2d3748;

    }



    /* Button to open modal */

    .code-open-btn {

        background: #0f172a;

        color: white;

        border: none;

        padding: 8px 16px;

        border-radius: 4px;

        cursor: pointer;

        font-size: 0.85em;

        font-weight: 500;

        margin: 5px 0;

        transition: all 0.3s ease;

    }



    .code-open-btn:hover {

        background: #1e293b;

        transform: translateY(-1px);

    }



    /* Copy button styles */

    .copy-btn {

        background: #1e3a8a;

        color: white;

        border: none;

        padding: 4px 8px;

        border-radius: 4px;

        cursor: pointer;

        font-size: 0.75em;

        display: flex;

        align-items: center;

        gap: 4px;

        transition: all 0.2s ease;

    }



    .copy-btn:hover {

        background: #1e40af;

    }



    .copy-btn.copied {

        background: #059669;

    }



    .copy-icon {

        width: 14px;

        height: 14px;

        fill: currentColor;

    }



    /* Hide original code blocks that have code-open */

    .cell[data-code-open="true"] .sourceCode {

        display: none;

    }



    .cell[data-code-open="true"] .cell-output {

        display: none;

    }



    /* Animation */

    @keyframes modalFadeIn {

        from {

            opacity: 0;

            transform: scale(0.8);

        }

        to {

            opacity: 1;

            transform: scale(1);

        }

    }



    .code-modal.show .code-modal-content {

        animation: modalFadeIn 0.3s ease-out;

    }



    /* Responsive */

    @media (max-width: 768px) {

        .code-modal-content {

            width: 95%;

            margin: 2% auto;

            max-height: 90vh;

        }



        .code-modal-header {

            padding: 10px 15px;

        }



        .code-modal-body {

            padding: 15px;

        }

    }

</style>



<script>

    document.addEventListener('DOMContentLoaded', function() {

        // Function to create modal

        function createModal() {

            const modal = document.createElement('div');

            modal.className = 'code-modal';

            document.body.appendChild(modal);

            return modal;

        }



        // Create the modal

        const modal = createModal();

        const modalContent = modal.querySelector('.code-modal-content');

        const closeBtn = modal.querySelector('.code-modal-close');

        const codeElement = modal.querySelector('.code-modal-code');

        const outputElement = modal.querySelector('.code-modal-output');



        // Function to open modal

        function openModal(codeText, outputText, title = 'Code & Output') {

            modal.querySelector('.code-modal-title').textContent = title;

            codeElement.textContent = codeText;

            outputElement.textContent = outputText || 'No output';

            modal.style.display = 'block';

            setTimeout(() => modal.classList.add('show'), 10);

            document.body.style.overflow = 'hidden';

        }



        // Function to close modal

        function closeModal() {

            modal.classList.remove('show');

            setTimeout(() => {

                modal.style.display = 'none';

                document.body.style.overflow = '';

            }, 300);

        }



        // Event listeners for modal

        closeBtn.addEventListener('click', closeModal);



        // Copy functionality

        const copyCodeBtn = modal.querySelector('#copy-code-btn');

        const copyOutputBtn = modal.querySelector('#copy-output-btn');



        copyCodeBtn.addEventListener('click', async function() {

            try {

                await navigator.clipboard.writeText(codeElement.textContent);

                copyCodeBtn.innerHTML = `

                    <svg class="copy-icon" viewBox="0 0 24 24">

                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>

                    </svg>

                    Copied!

                `;

                copyCodeBtn.classList.add('copied');

                setTimeout(() => {

                    copyCodeBtn.innerHTML = `

                        <svg class="copy-icon" viewBox="0 0 24 24">

                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>

                        </svg>

                        Copy

                    `;

                    copyCodeBtn.classList.remove('copied');

                }, 2000);

            } catch (err) {

                console.error('Failed to copy code:', err);

            }

        });



        copyOutputBtn.addEventListener('click', async function() {

            try {

                await navigator.clipboard.writeText(outputElement.textContent);

                copyOutputBtn.innerHTML = `

                    <svg class="copy-icon" viewBox="0 0 24 24">

                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>

                    </svg>

                    Copied!

                `;

                copyOutputBtn.classList.add('copied');

                setTimeout(() => {

                    copyOutputBtn.innerHTML = `

                        <svg class="copy-icon" viewBox="0 0 24 24">

                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>

                        </svg>

                        Copy

                    `;

                    copyOutputBtn.classList.remove('copied');

                }, 2000);

            } catch (err) {

                console.error('Failed to copy output:', err);

            }

        });



        modal.addEventListener('click', function(e) {

            if (e.target === modal) {

                closeModal();

            }

        });



        document.addEventListener('keydown', function(e) {

            if (e.key === 'Escape' && modal.style.display === 'block') {

                closeModal();

            }

        });



        // Function to extract title from Quarto cell metadata

        function extractTitleFromCell(cell) {

            // Look for code-modal-title in various places

            let title = null;



            // 1. Check for data attribute on the cell

            if (cell.hasAttribute('data-code-modal-title')) {

                title = cell.getAttribute('data-code-modal-title');

            }



            // 2. Check for code-modal-title in cell options (Quarto metadata)

            const cellOptions = cell.querySelector('.cell-meta, .cell-code-meta');

            if (cellOptions && !title) {

                const optionsText = cellOptions.textContent;

                const titleMatch = optionsText.match(/code-modal-title:\s*["']([^"']+)["']/);

                if (titleMatch) {

                    title = titleMatch[1];

                }

            }



            // 3. Look for title in HTML comments (Quarto sometimes puts metadata there)

            const htmlContent = cell.innerHTML;

            const commentMatch = htmlContent.match(/<!--.*?code-modal-title:\s*["']([^"']+)["'].*?-->/s);

            if (commentMatch && !title) {

                title = commentMatch[1];

            }



            // 4. Look for title in the cell's script tags or data attributes

            const scripts = cell.querySelectorAll('script[type="application/json"]');

            scripts.forEach(script => {

                if (!title) {

                    try {

                        const data = JSON.parse(script.textContent);

                        if (data['code-modal-title']) {

                            title = data['code-modal-title'];

                        }

                    } catch (e) {

                        // Ignore JSON parse errors

                    }

                }

            });



            // 5. Look in the raw text content for the pattern

            if (!title) {

                const rawText = cell.textContent;

                const rawMatch = rawText.match(/code-modal-title:\s*["']?([^"'\n]+)["']?/);

                if (rawMatch) {

                    title = rawMatch[1].trim().replace(/["']/g, '');

                }

            }



            // 6. Alternative pattern matching for YAML-like syntax

            if (!title) {

                const yamlMatch = htmlContent.match(/code-modal-title:\s*(.+)/);

                if (yamlMatch) {

                    title = yamlMatch[1].trim().replace(/["']/g, '');

                }

            }



            return title;

        }



        // Function to process code blocks with code-open attribute

        function processCodeOpenBlocks() {

            // Look for cells with code-open attribute in Quarto

            const cells = document.querySelectorAll('.cell');



            cells.forEach((cell, index) => {

                // Skip if already processed

                if (cell.hasAttribute('data-processed')) return;



                // Check if this cell should have code-open functionality

                const hasCodeOpen = cell.querySelector('[data-code-open="true"]') ||

                    cell.hasAttribute('data-code-open') ||

                    cell.innerHTML.includes('code-open: true') ||

                    cell.textContent.includes('code-open: true');



                if (hasCodeOpen) {

                    // Mark the cell as processed

                    cell.setAttribute('data-code-open', 'true');

                    cell.setAttribute('data-processed', 'true');



                    // Extract custom title

                    const customTitle = extractTitleFromCell(cell);



                    // Find source code

                    const sourceCode = cell.querySelector('.sourceCode code, pre code, .r code');

                    const codeText = sourceCode ? sourceCode.textContent : '';



                    // Find output

                    const outputElements = cell.querySelectorAll('.cell-output pre, .cell-output .output');

                    let outputText = '';

                    outputElements.forEach(output => {

                        outputText += output.textContent + '\n';

                    });



                    // Create open button

                    const openBtn = document.createElement('button');

                    openBtn.className = 'code-open-btn';

                    openBtn.textContent = 'View Code & Output';



                    openBtn.addEventListener('click', function() {

                        // Use custom title if available, otherwise default

                        const title = customTitle || `Code Block ${index + 1}`;

                        openModal(codeText, outputText.trim(), title);

                    });



                    // Insert button at the beginning of the cell

                    cell.insertBefore(openBtn, cell.firstChild);

                }

            });

        }



        // Alternative approach for direct code blocks

        function processDirectCodeBlocks() {

            const codeBlocks = document.querySelectorAll('pre code');



            codeBlocks.forEach(code => {

                const preElement = code.parentElement;

                const container = preElement.parentElement;



                // Skip if already processed

                if (container.hasAttribute('data-processed')) return;



                // Check for code-open in various ways

                if (container.hasAttribute('data-code-open') ||

                    container.classList.contains('code-open') ||

                    preElement.hasAttribute('data-code-open') ||

                    container.innerHTML.includes('code-open: true')) {



                    // Mark as processed

                    container.setAttribute('data-processed', 'true');



                    // Extract custom title

                    const customTitle = extractTitleFromCell(container);



                    const codeText = code.textContent;



                    // Look for adjacent output

                    let outputText = '';

                    let nextElement = container.nextElementSibling;

                    if (nextElement && (nextElement.tagName === 'PRE' || nextElement.classList.contains('output'))) {

                        outputText = nextElement.textContent;

                    }



                    // Create and insert button

                    const openBtn = document.createElement('button');

                    openBtn.className = 'code-open-btn';

                    openBtn.textContent = 'View Code & Output';



                    openBtn.addEventListener('click', function() {

                        const title = customTitle || 'Code Block';

                        openModal(codeText, outputText, title);

                    });



                    // Hide original and add button

                    container.style.display = 'none';

                    if (nextElement && outputText) {

                        nextElement.style.display = 'none';

                    }



                    container.parentElement.insertBefore(openBtn, container);

                }

            });

        }



        // Run processing functions

        processCodeOpenBlocks();

        processDirectCodeBlocks();



        // Also run after a short delay to catch dynamically loaded content

        setTimeout(() => {

            processCodeOpenBlocks();

            processDirectCodeBlocks();

        }, 1000);



        // Run again after a longer delay for slow-loading content

        setTimeout(() => {

            processCodeOpenBlocks();

            processDirectCodeBlocks();

        }, 3000);

    });



    // Manual function to add code-open functionality

    function addCodeOpen(codeElement, outputElement, title) {

        const openBtn = document.createElement('button');

        openBtn.className = 'code-open-btn';

        openBtn.textContent = 'View Code & Output';



        openBtn.addEventListener('click', function() {

            const codeText = codeElement.textContent;

            const outputText = outputElement ? outputElement.textContent : '';



            // Trigger the modal (assuming the modal is already created)

            const modal = document.querySelector('.code-modal');

            if (modal) {

                const event = new CustomEvent('openCodeModal', {

                    detail: { codeText, outputText, title }

                });

                document.dispatchEvent(event);

            }

        });



        return openBtn;

    }



    // Listen for custom events

    document.addEventListener('openCodeModal', function(e) {

        const { codeText, outputText, title } = e.detail;

        const modal = document.querySelector('.code-modal');

        if (modal) {

            modal.querySelector('.code-modal-title').textContent = title || 'Code & Output';

            modal.querySelector('.code-modal-code').textContent = codeText;

            modal.querySelector('.code-modal-output').textContent = outputText || 'No output';

            modal.style.display = 'block';

            setTimeout(() => modal.classList.add('show'), 10);

            document.body.style.overflow = 'hidden';

        }

    });

</script>



<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/joshuamarie\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="joshuamarie/joshuamarie" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Design inspired by <a href="https://github.com/statichunt/geeky-hugo">Geeky Hugo</a></p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/joshuamarie/joshuamarie/edit/main/posts/08-sql-r/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/joshuamarie/joshuamarie/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>